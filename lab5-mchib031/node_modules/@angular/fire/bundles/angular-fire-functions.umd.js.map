{"version":3,"file":"angular-fire-functions.umd.js","sources":["../../../src/functions/functions.ts","../../../src/functions/functions.module.ts","../../../src/functions/rxfire.ts","../../../src/functions/firebase.ts","../../../src/functions/angular-fire-functions.ts"],"sourcesContent":["import { Functions as FirebaseFunctions } from 'firebase/functions';\nimport { ɵgetAllInstancesOf } from '@angular/fire';\nimport { from, timer } from 'rxjs';\nimport { concatMap, distinct } from 'rxjs/operators';\n\n// see notes in core/firebase.app.module.ts for why we're building the class like this\n// tslint:disable-next-line:no-empty-interface\nexport interface Functions extends FirebaseFunctions {}\n\nexport class Functions {\n  constructor(functions: FirebaseFunctions) {\n    return functions;\n  }\n}\n\nexport const FUNCTIONS_PROVIDER_NAME = 'functions';\n\n// tslint:disable-next-line:no-empty-interface\nexport interface FunctionsInstances extends Array<FirebaseFunctions> {}\n\nexport class FunctionsInstances {\n  constructor() {\n    return ɵgetAllInstancesOf<FirebaseFunctions>(FUNCTIONS_PROVIDER_NAME);\n  }\n}\n\nexport const functionInstance$ = timer(0, 300).pipe(\n  concatMap(() => from(ɵgetAllInstancesOf<FirebaseFunctions>(FUNCTIONS_PROVIDER_NAME))),\n  distinct(),\n);\n","import { NgModule, Optional, NgZone, InjectionToken, ModuleWithProviders } from '@angular/core';\nimport { Functions as FirebaseFunctions } from 'firebase/functions';\nimport { ɵgetDefaultInstanceOf, ɵmemoizeInstance, ɵAngularFireSchedulers, VERSION } from '@angular/fire';\nimport { Functions, FunctionsInstances, FUNCTIONS_PROVIDER_NAME } from './functions';\nimport { FirebaseApps, FirebaseApp } from '@angular/fire/app';\nimport { AuthInstances } from '@angular/fire/auth';\nimport { registerVersion } from 'firebase/app';\n\nexport const PROVIDED_FUNCTIONS_INSTANCES = new InjectionToken<Functions[]>('angularfire2.functions-instances');\n\nexport function defaultFunctionsInstanceFactory(provided: FirebaseFunctions[]|undefined, defaultApp: FirebaseApp) {\n  const defaultAuth = ɵgetDefaultInstanceOf<FirebaseFunctions>(FUNCTIONS_PROVIDER_NAME, provided, defaultApp);\n  return new Functions(defaultAuth);\n}\n\nexport function functionsInstanceFactory(fn: () => FirebaseFunctions) {\n  return (zone: NgZone) => {\n    const functions = ɵmemoizeInstance<FirebaseFunctions>(fn, zone);\n    return new Functions(functions);\n  };\n}\n\nconst FUNCTIONS_INSTANCES_PROVIDER = {\n  provide: FunctionsInstances,\n  deps: [\n    [new Optional(), PROVIDED_FUNCTIONS_INSTANCES ],\n  ]\n};\n\nconst DEFAULT_FUNCTIONS_INSTANCE_PROVIDER = {\n  provide: Functions,\n  useFactory: defaultFunctionsInstanceFactory,\n  deps: [\n    [new Optional(), PROVIDED_FUNCTIONS_INSTANCES ],\n    FirebaseApp,\n  ]\n};\n\n@NgModule({\n  providers: [\n    DEFAULT_FUNCTIONS_INSTANCE_PROVIDER,\n    FUNCTIONS_INSTANCES_PROVIDER,\n  ]\n})\nexport class FunctionsModule {\n  constructor() {\n    registerVersion('angularfire', VERSION.full, 'fn');\n  }\n}\n\nexport function provideFunctions(fn: () => FirebaseFunctions): ModuleWithProviders<FunctionsModule> {\n  return {\n    ngModule: FunctionsModule,\n    providers: [{\n      provide: PROVIDED_FUNCTIONS_INSTANCES,\n      useFactory: functionsInstanceFactory(fn),\n      multi: true,\n      deps: [\n        NgZone,\n        ɵAngularFireSchedulers,\n        FirebaseApps,\n        // Defensively load Auth first, if provided\n        [new Optional(), AuthInstances ],\n      ]\n    }]\n  };\n}\n","// DO NOT MODIFY, this file is autogenerated by tools/build.ts\nimport { ɵzoneWrap } from '@angular/fire';\nimport {\n  httpsCallable as _httpsCallable\n} from 'rxfire/functions';\n\nexport const httpsCallableData = ɵzoneWrap(_httpsCallable, true);\n","// DO NOT MODIFY, this file is autogenerated by tools/build.ts\nexport * from 'firebase/functions';\nimport { ɵzoneWrap } from '@angular/fire';\nimport {\n  connectFunctionsEmulator as _connectFunctionsEmulator,\n  getFunctions as _getFunctions,\n  httpsCallable as _httpsCallable\n} from 'firebase/functions';\n\nexport const connectFunctionsEmulator = ɵzoneWrap(_connectFunctionsEmulator, true);\nexport const getFunctions = ɵzoneWrap(_getFunctions, true);\nexport const httpsCallable = ɵzoneWrap(_httpsCallable, true);\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["ɵgetAllInstancesOf","timer","concatMap","from","distinct","InjectionToken","ɵgetDefaultInstanceOf","ɵmemoizeInstance","Optional","FirebaseApp","registerVersion","VERSION","NgModule","NgZone","ɵAngularFireSchedulers","FirebaseApps","AuthInstances","ɵzoneWrap","_httpsCallable","_connectFunctionsEmulator","_getFunctions"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAUE,mBAAY,SAA4B;YACtC,OAAO,SAAS,CAAC;SAClB;wBACF;KAAA,IAAA;IAEM,IAAM,uBAAuB,GAAG,WAAW,CAAC;;QAMjD;YACE,OAAOA,uBAAkB,CAAoB,uBAAuB,CAAC,CAAC;SACvE;iCACF;KAAA,IAAA;QAEY,iBAAiB,GAAGC,UAAK,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,IAAI,CACjDC,mBAAS,CAAC,cAAM,OAAAC,SAAI,CAACH,uBAAkB,CAAoB,uBAAuB,CAAC,CAAC,GAAA,CAAC,EACrFI,kBAAQ,EAAE;;ICpBL,IAAM,4BAA4B,GAAG,IAAIC,iBAAc,CAAc,kCAAkC,CAAC,CAAC;aAEhG,+BAA+B,CAAC,QAAuC,EAAE,UAAuB;QAC9G,IAAM,WAAW,GAAGC,0BAAqB,CAAoB,uBAAuB,EAAE,QAAQ,EAAE,UAAU,CAAC,CAAC;QAC5G,OAAO,IAAI,SAAS,CAAC,WAAW,CAAC,CAAC;IACpC,CAAC;aAEe,wBAAwB,CAAC,EAA2B;QAClE,OAAO,UAAC,IAAY;YAClB,IAAM,SAAS,GAAGC,qBAAgB,CAAoB,EAAE,EAAE,IAAI,CAAC,CAAC;YAChE,OAAO,IAAI,SAAS,CAAC,SAAS,CAAC,CAAC;SACjC,CAAC;IACJ,CAAC;IAED,IAAM,4BAA4B,GAAG;QACnC,OAAO,EAAE,kBAAkB;QAC3B,IAAI,EAAE;YACJ,CAAC,IAAIC,WAAQ,EAAE,EAAE,4BAA4B,CAAE;SAChD;KACF,CAAC;IAEF,IAAM,mCAAmC,GAAG;QAC1C,OAAO,EAAE,SAAS;QAClB,UAAU,EAAE,+BAA+B;QAC3C,IAAI,EAAE;YACJ,CAAC,IAAIA,WAAQ,EAAE,EAAE,4BAA4B,CAAE;YAC/CC,eAAW;SACZ;KACF,CAAC;;QASA;YACEC,qBAAe,CAAC,aAAa,EAAEC,YAAO,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;SACpD;;;sIAHU,eAAe;uIAAf,eAAe;uIAAf,eAAe,aALf;YACT,mCAAmC;YACnC,4BAA4B;SAC7B;qHAEU,eAAe;sBAN3BC,WAAQ;uBAAC;wBACR,SAAS,EAAE;4BACT,mCAAmC;4BACnC,4BAA4B;yBAC7B;qBACF;;aAOe,gBAAgB,CAAC,EAA2B;QAC1D,OAAO;YACL,QAAQ,EAAE,eAAe;YACzB,SAAS,EAAE,CAAC;oBACV,OAAO,EAAE,4BAA4B;oBACrC,UAAU,EAAE,wBAAwB,CAAC,EAAE,CAAC;oBACxC,KAAK,EAAE,IAAI;oBACX,IAAI,EAAE;wBACJC,SAAM;wBACNC,2BAAsB;wBACtBC,gBAAY;;wBAEZ,CAAC,IAAIP,WAAQ,EAAE,EAAEQ,kBAAa,CAAE;qBACjC;iBACF,CAAC;SACH,CAAC;IACJ;;IClEA;QAMa,iBAAiB,GAAGC,cAAS,CAACC,yBAAc,EAAE,IAAI;;ICN/D;QASa,wBAAwB,GAAGD,cAAS,CAACE,kCAAyB,EAAE,IAAI,EAAE;QACtE,YAAY,GAAGF,cAAS,CAACG,sBAAa,EAAE,IAAI,EAAE;QAC9C,aAAa,GAAGH,cAAS,CAACC,uBAAc,EAAE,IAAI;;ICX3D;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}