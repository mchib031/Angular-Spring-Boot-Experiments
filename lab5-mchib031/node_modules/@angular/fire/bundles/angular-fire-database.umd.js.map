{"version":3,"file":"angular-fire-database.umd.js","sources":["../../../src/database/database.ts","../../../src/database/database.module.ts","../../../src/database/rxfire.ts","../../../src/database/firebase.ts","../../../src/database/angular-fire-database.ts"],"sourcesContent":["import { Database as FirebaseDatabase } from 'firebase/database';\nimport { ɵgetAllInstancesOf } from '@angular/fire';\nimport { from, timer } from 'rxjs';\nimport { concatMap, distinct } from 'rxjs/operators';\n\n// see notes in core/firebase.app.module.ts for why we're building the class like this\n// tslint:disable-next-line:no-empty-interface\nexport interface Database extends FirebaseDatabase {}\n\nexport class Database {\n  constructor(database: FirebaseDatabase) {\n    return database;\n  }\n}\n\nexport const DATABASE_PROVIDER_NAME = 'database';\n\n// tslint:disable-next-line:no-empty-interface\nexport interface DatabaseInstances extends Array<FirebaseDatabase> {}\n\nexport class DatabaseInstances {\n  constructor() {\n    return ɵgetAllInstancesOf<FirebaseDatabase>(DATABASE_PROVIDER_NAME);\n  }\n}\n\nexport const databaseInstance$ = timer(0, 300).pipe(\n  concatMap(() => from(ɵgetAllInstancesOf<FirebaseDatabase>(DATABASE_PROVIDER_NAME))),\n  distinct(),\n);\n","import { NgModule, Optional, NgZone, InjectionToken, ModuleWithProviders } from '@angular/core';\nimport { Database as FirebaseDatabase } from 'firebase/database';\n\nimport { AuthInstances } from '@angular/fire/auth';\nimport { ɵgetDefaultInstanceOf, ɵmemoizeInstance, ɵAngularFireSchedulers, VERSION } from '@angular/fire';\nimport { Database, DatabaseInstances, DATABASE_PROVIDER_NAME } from './database';\nimport { FirebaseApps, FirebaseApp } from '@angular/fire/app';\nimport { registerVersion } from 'firebase/app';\n\nexport const PROVIDED_DATABASE_INSTANCES = new InjectionToken<Database[]>('angularfire2.database-instances');\n\nexport function defaultDatabaseInstanceFactory(provided: FirebaseDatabase[]|undefined, defaultApp: FirebaseApp) {\n  const defaultDatabase = ɵgetDefaultInstanceOf<FirebaseDatabase>(DATABASE_PROVIDER_NAME, provided, defaultApp);\n  return new Database(defaultDatabase);\n}\n\nexport function databaseInstanceFactory(fn: () => FirebaseDatabase) {\n  return (zone: NgZone) => {\n    const database = ɵmemoizeInstance<FirebaseDatabase>(fn, zone);\n    return new Database(database);\n  };\n}\n\nconst DATABASE_INSTANCES_PROVIDER = {\n  provide: DatabaseInstances,\n  deps: [\n    [new Optional(), PROVIDED_DATABASE_INSTANCES ],\n  ]\n};\n\nconst DEFAULT_DATABASE_INSTANCE_PROVIDER = {\n  provide: Database,\n  useFactory: defaultDatabaseInstanceFactory,\n  deps: [\n    [new Optional(), PROVIDED_DATABASE_INSTANCES ],\n    FirebaseApp,\n  ]\n};\n\n@NgModule({\n  providers: [\n    DEFAULT_DATABASE_INSTANCE_PROVIDER,\n    DATABASE_INSTANCES_PROVIDER,\n  ]\n})\nexport class DatabaseModule {\n  constructor() {\n    registerVersion('angularfire', VERSION.full, 'rtdb');\n  }\n}\n\nexport function provideDatabase(fn: () => FirebaseDatabase): ModuleWithProviders<DatabaseModule> {\n  return {\n    ngModule: DatabaseModule,\n    providers: [{\n      provide: PROVIDED_DATABASE_INSTANCES,\n      useFactory: databaseInstanceFactory(fn),\n      multi: true,\n      deps: [\n        NgZone,\n        ɵAngularFireSchedulers,\n        FirebaseApps,\n        // Database+Auth work better if Auth is loaded first\n        [new Optional(), AuthInstances ],\n      ]\n    }]\n  };\n}\n","// DO NOT MODIFY, this file is autogenerated by tools/build.ts\nimport { ɵzoneWrap } from '@angular/fire';\nimport {\n  fromRef as _fromRef,\n  stateChanges as _stateChanges,\n  list as _list,\n  listVal as _listVal,\n  auditTrail as _auditTrail,\n  object as _object,\n  objectVal as _objectVal,\n  changeToData as _changeToData\n} from 'rxfire/database';\n\nexport {\n  ListenEvent,\n  ListenerMethods\n} from 'rxfire/database';\n\nexport const fromRef = ɵzoneWrap(_fromRef, true);\nexport const stateChanges = ɵzoneWrap(_stateChanges, true);\nexport const list = ɵzoneWrap(_list, true);\nexport const listVal = ɵzoneWrap(_listVal, true);\nexport const auditTrail = ɵzoneWrap(_auditTrail, true);\nexport const object = ɵzoneWrap(_object, true);\nexport const objectVal = ɵzoneWrap(_objectVal, true);\nexport const changeToData = ɵzoneWrap(_changeToData, true);\n","// DO NOT MODIFY, this file is autogenerated by tools/build.ts\nexport * from 'firebase/database';\nimport { ɵzoneWrap } from '@angular/fire';\nimport {\n  child as _child,\n  connectDatabaseEmulator as _connectDatabaseEmulator,\n  enableLogging as _enableLogging,\n  endAt as _endAt,\n  endBefore as _endBefore,\n  equalTo as _equalTo,\n  get as _get,\n  getDatabase as _getDatabase,\n  goOffline as _goOffline,\n  goOnline as _goOnline,\n  increment as _increment,\n  limitToFirst as _limitToFirst,\n  limitToLast as _limitToLast,\n  off as _off,\n  onChildAdded as _onChildAdded,\n  onChildChanged as _onChildChanged,\n  onChildMoved as _onChildMoved,\n  onChildRemoved as _onChildRemoved,\n  onDisconnect as _onDisconnect,\n  onValue as _onValue,\n  orderByChild as _orderByChild,\n  orderByKey as _orderByKey,\n  orderByPriority as _orderByPriority,\n  orderByValue as _orderByValue,\n  push as _push,\n  query as _query,\n  ref as _ref,\n  refFromURL as _refFromURL,\n  remove as _remove,\n  runTransaction as _runTransaction,\n  serverTimestamp as _serverTimestamp,\n  set as _set,\n  setPriority as _setPriority,\n  setWithPriority as _setWithPriority,\n  startAfter as _startAfter,\n  startAt as _startAt,\n  update as _update\n} from 'firebase/database';\n\nexport const child = ɵzoneWrap(_child, true);\nexport const connectDatabaseEmulator = ɵzoneWrap(_connectDatabaseEmulator, true);\nexport const enableLogging = ɵzoneWrap(_enableLogging, true);\nexport const endAt = ɵzoneWrap(_endAt, true);\nexport const endBefore = ɵzoneWrap(_endBefore, true);\nexport const equalTo = ɵzoneWrap(_equalTo, true);\nexport const get = ɵzoneWrap(_get, true);\nexport const getDatabase = ɵzoneWrap(_getDatabase, true);\nexport const goOffline = ɵzoneWrap(_goOffline, true);\nexport const goOnline = ɵzoneWrap(_goOnline, true);\nexport const increment = ɵzoneWrap(_increment, true);\nexport const limitToFirst = ɵzoneWrap(_limitToFirst, true);\nexport const limitToLast = ɵzoneWrap(_limitToLast, true);\nexport const off = ɵzoneWrap(_off, true);\nexport const onChildAdded = ɵzoneWrap(_onChildAdded, true);\nexport const onChildChanged = ɵzoneWrap(_onChildChanged, true);\nexport const onChildMoved = ɵzoneWrap(_onChildMoved, true);\nexport const onChildRemoved = ɵzoneWrap(_onChildRemoved, true);\nexport const onDisconnect = ɵzoneWrap(_onDisconnect, true);\nexport const onValue = ɵzoneWrap(_onValue, true);\nexport const orderByChild = ɵzoneWrap(_orderByChild, true);\nexport const orderByKey = ɵzoneWrap(_orderByKey, true);\nexport const orderByPriority = ɵzoneWrap(_orderByPriority, true);\nexport const orderByValue = ɵzoneWrap(_orderByValue, true);\nexport const push = ɵzoneWrap(_push, true);\nexport const query = ɵzoneWrap(_query, true);\nexport const ref = ɵzoneWrap(_ref, true);\nexport const refFromURL = ɵzoneWrap(_refFromURL, true);\nexport const remove = ɵzoneWrap(_remove, true);\nexport const runTransaction = ɵzoneWrap(_runTransaction, true);\nexport const serverTimestamp = ɵzoneWrap(_serverTimestamp, true);\nexport const set = ɵzoneWrap(_set, true);\nexport const setPriority = ɵzoneWrap(_setPriority, true);\nexport const setWithPriority = ɵzoneWrap(_setWithPriority, true);\nexport const startAfter = ɵzoneWrap(_startAfter, true);\nexport const startAt = ɵzoneWrap(_startAt, true);\nexport const update = ɵzoneWrap(_update, true);\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["ɵgetAllInstancesOf","timer","concatMap","from","distinct","InjectionToken","ɵgetDefaultInstanceOf","ɵmemoizeInstance","Optional","FirebaseApp","registerVersion","VERSION","NgModule","NgZone","ɵAngularFireSchedulers","FirebaseApps","AuthInstances","ɵzoneWrap","_fromRef","_stateChanges","_list","_listVal","_auditTrail","_object","_objectVal","_changeToData","_child","_connectDatabaseEmulator","_enableLogging","_endAt","_endBefore","_equalTo","_get","_getDatabase","_goOffline","_goOnline","_increment","_limitToFirst","_limitToLast","_off","_onChildAdded","_onChildChanged","_onChildMoved","_onChildRemoved","_onDisconnect","_onValue","_orderByChild","_orderByKey","_orderByPriority","_orderByValue","_push","_query","_ref","_refFromURL","_remove","_runTransaction","_serverTimestamp","_set","_setPriority","_setWithPriority","_startAfter","_startAt","_update"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAUE,kBAAY,QAA0B;YACpC,OAAO,QAAQ,CAAC;SACjB;uBACF;KAAA,IAAA;IAEM,IAAM,sBAAsB,GAAG,UAAU,CAAC;;QAM/C;YACE,OAAOA,uBAAkB,CAAmB,sBAAsB,CAAC,CAAC;SACrE;gCACF;KAAA,IAAA;QAEY,iBAAiB,GAAGC,UAAK,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,IAAI,CACjDC,mBAAS,CAAC,cAAM,OAAAC,SAAI,CAACH,uBAAkB,CAAmB,sBAAsB,CAAC,CAAC,GAAA,CAAC,EACnFI,kBAAQ,EAAE;;ICnBL,IAAM,2BAA2B,GAAG,IAAIC,iBAAc,CAAa,iCAAiC,CAAC,CAAC;aAE7F,8BAA8B,CAAC,QAAsC,EAAE,UAAuB;QAC5G,IAAM,eAAe,GAAGC,0BAAqB,CAAmB,sBAAsB,EAAE,QAAQ,EAAE,UAAU,CAAC,CAAC;QAC9G,OAAO,IAAI,QAAQ,CAAC,eAAe,CAAC,CAAC;IACvC,CAAC;aAEe,uBAAuB,CAAC,EAA0B;QAChE,OAAO,UAAC,IAAY;YAClB,IAAM,QAAQ,GAAGC,qBAAgB,CAAmB,EAAE,EAAE,IAAI,CAAC,CAAC;YAC9D,OAAO,IAAI,QAAQ,CAAC,QAAQ,CAAC,CAAC;SAC/B,CAAC;IACJ,CAAC;IAED,IAAM,2BAA2B,GAAG;QAClC,OAAO,EAAE,iBAAiB;QAC1B,IAAI,EAAE;YACJ,CAAC,IAAIC,WAAQ,EAAE,EAAE,2BAA2B,CAAE;SAC/C;KACF,CAAC;IAEF,IAAM,kCAAkC,GAAG;QACzC,OAAO,EAAE,QAAQ;QACjB,UAAU,EAAE,8BAA8B;QAC1C,IAAI,EAAE;YACJ,CAAC,IAAIA,WAAQ,EAAE,EAAE,2BAA2B,CAAE;YAC9CC,eAAW;SACZ;KACF,CAAC;;QASA;YACEC,qBAAe,CAAC,aAAa,EAAEC,YAAO,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;SACtD;;;qIAHU,cAAc;sIAAd,cAAc;sIAAd,cAAc,aALd;YACT,kCAAkC;YAClC,2BAA2B;SAC5B;qHAEU,cAAc;sBAN1BC,WAAQ;uBAAC;wBACR,SAAS,EAAE;4BACT,kCAAkC;4BAClC,2BAA2B;yBAC5B;qBACF;;aAOe,eAAe,CAAC,EAA0B;QACxD,OAAO;YACL,QAAQ,EAAE,cAAc;YACxB,SAAS,EAAE,CAAC;oBACV,OAAO,EAAE,2BAA2B;oBACpC,UAAU,EAAE,uBAAuB,CAAC,EAAE,CAAC;oBACvC,KAAK,EAAE,IAAI;oBACX,IAAI,EAAE;wBACJC,SAAM;wBACNC,2BAAsB;wBACtBC,gBAAY;;wBAEZ,CAAC,IAAIP,WAAQ,EAAE,EAAEQ,kBAAa,CAAE;qBACjC;iBACF,CAAC;SACH,CAAC;IACJ;;ICnEA;QAkBa,OAAO,GAAGC,cAAS,CAACC,gBAAQ,EAAE,IAAI,EAAE;QACpC,YAAY,GAAGD,cAAS,CAACE,qBAAa,EAAE,IAAI,EAAE;QAC9C,IAAI,GAAGF,cAAS,CAACG,aAAK,EAAE,IAAI,EAAE;QAC9B,OAAO,GAAGH,cAAS,CAACI,gBAAQ,EAAE,IAAI,EAAE;QACpC,UAAU,GAAGJ,cAAS,CAACK,mBAAW,EAAE,IAAI,EAAE;QAC1C,MAAM,GAAGL,cAAS,CAACM,eAAO,EAAE,IAAI,EAAE;QAClC,SAAS,GAAGN,cAAS,CAACO,kBAAU,EAAE,IAAI,EAAE;QACxC,YAAY,GAAGP,cAAS,CAACQ,qBAAa,EAAE,IAAI;;ICzBzD;QA2Ca,KAAK,GAAGR,cAAS,CAACS,gBAAM,EAAE,IAAI,EAAE;QAChC,uBAAuB,GAAGT,cAAS,CAACU,kCAAwB,EAAE,IAAI,EAAE;QACpE,aAAa,GAAGV,cAAS,CAACW,wBAAc,EAAE,IAAI,EAAE;QAChD,KAAK,GAAGX,cAAS,CAACY,gBAAM,EAAE,IAAI,EAAE;QAChC,SAAS,GAAGZ,cAAS,CAACa,oBAAU,EAAE,IAAI,EAAE;QACxC,OAAO,GAAGb,cAAS,CAACc,kBAAQ,EAAE,IAAI,EAAE;QACpC,GAAG,GAAGd,cAAS,CAACe,cAAI,EAAE,IAAI,EAAE;QAC5B,WAAW,GAAGf,cAAS,CAACgB,sBAAY,EAAE,IAAI,EAAE;QAC5C,SAAS,GAAGhB,cAAS,CAACiB,oBAAU,EAAE,IAAI,EAAE;QACxC,QAAQ,GAAGjB,cAAS,CAACkB,mBAAS,EAAE,IAAI,EAAE;QACtC,SAAS,GAAGlB,cAAS,CAACmB,oBAAU,EAAE,IAAI,EAAE;QACxC,YAAY,GAAGnB,cAAS,CAACoB,uBAAa,EAAE,IAAI,EAAE;QAC9C,WAAW,GAAGpB,cAAS,CAACqB,sBAAY,EAAE,IAAI,EAAE;QAC5C,GAAG,GAAGrB,cAAS,CAACsB,cAAI,EAAE,IAAI,EAAE;QAC5B,YAAY,GAAGtB,cAAS,CAACuB,uBAAa,EAAE,IAAI,EAAE;QAC9C,cAAc,GAAGvB,cAAS,CAACwB,yBAAe,EAAE,IAAI,EAAE;QAClD,YAAY,GAAGxB,cAAS,CAACyB,uBAAa,EAAE,IAAI,EAAE;QAC9C,cAAc,GAAGzB,cAAS,CAAC0B,yBAAe,EAAE,IAAI,EAAE;QAClD,YAAY,GAAG1B,cAAS,CAAC2B,uBAAa,EAAE,IAAI,EAAE;QAC9C,OAAO,GAAG3B,cAAS,CAAC4B,kBAAQ,EAAE,IAAI,EAAE;QACpC,YAAY,GAAG5B,cAAS,CAAC6B,uBAAa,EAAE,IAAI,EAAE;QAC9C,UAAU,GAAG7B,cAAS,CAAC8B,qBAAW,EAAE,IAAI,EAAE;QAC1C,eAAe,GAAG9B,cAAS,CAAC+B,0BAAgB,EAAE,IAAI,EAAE;QACpD,YAAY,GAAG/B,cAAS,CAACgC,uBAAa,EAAE,IAAI,EAAE;QAC9C,IAAI,GAAGhC,cAAS,CAACiC,eAAK,EAAE,IAAI,EAAE;QAC9B,KAAK,GAAGjC,cAAS,CAACkC,gBAAM,EAAE,IAAI,EAAE;QAChC,GAAG,GAAGlC,cAAS,CAACmC,cAAI,EAAE,IAAI,EAAE;QAC5B,UAAU,GAAGnC,cAAS,CAACoC,qBAAW,EAAE,IAAI,EAAE;QAC1C,MAAM,GAAGpC,cAAS,CAACqC,iBAAO,EAAE,IAAI,EAAE;QAClC,cAAc,GAAGrC,cAAS,CAACsC,yBAAe,EAAE,IAAI,EAAE;QAClD,eAAe,GAAGtC,cAAS,CAACuC,0BAAgB,EAAE,IAAI,EAAE;QACpD,GAAG,GAAGvC,cAAS,CAACwC,cAAI,EAAE,IAAI,EAAE;QAC5B,WAAW,GAAGxC,cAAS,CAACyC,sBAAY,EAAE,IAAI,EAAE;QAC5C,eAAe,GAAGzC,cAAS,CAAC0C,0BAAgB,EAAE,IAAI,EAAE;QACpD,UAAU,GAAG1C,cAAS,CAAC2C,qBAAW,EAAE,IAAI,EAAE;QAC1C,OAAO,GAAG3C,cAAS,CAAC4C,kBAAQ,EAAE,IAAI,EAAE;QACpC,MAAM,GAAG5C,cAAS,CAAC6C,iBAAO,EAAE,IAAI;;IC/E7C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}