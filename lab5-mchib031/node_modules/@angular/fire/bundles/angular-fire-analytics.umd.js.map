{"version":3,"file":"angular-fire-analytics.umd.js","sources":["../../../src/analytics/analytics.ts","../../../src/analytics/analytics.module.ts","../../../src/analytics/firebase.ts","../../../src/analytics/angular-fire-analytics.ts"],"sourcesContent":["import { Analytics as FirebaseAnalytics } from 'firebase/analytics';\nimport { ɵgetAllInstancesOf } from '@angular/fire';\nimport { from, timer } from 'rxjs';\nimport { concatMap, distinct } from 'rxjs/operators';\n\n// see notes in core/firebase.app.module.ts for why we're building the class like this\n// tslint:disable-next-line:no-empty-interface\nexport interface Analytics extends FirebaseAnalytics {}\n\nexport class Analytics {\n  constructor(analytics: FirebaseAnalytics) {\n    return analytics;\n  }\n}\n\nexport const ANALYTICS_PROVIDER_NAME = 'analytics';\n\n// tslint:disable-next-line:no-empty-interface\nexport interface AnalyticsInstances extends Array<FirebaseAnalytics> {}\n\nexport class AnalyticsInstances {\n  constructor() {\n    return ɵgetAllInstancesOf<FirebaseAnalytics>(ANALYTICS_PROVIDER_NAME);\n  }\n}\n\nexport const analyticInstance$ = timer(0, 300).pipe(\n  concatMap(() => from(ɵgetAllInstancesOf<FirebaseAnalytics>(ANALYTICS_PROVIDER_NAME))),\n  distinct(),\n);\n","import { NgModule, Optional, NgZone, InjectionToken, ModuleWithProviders, APP_INITIALIZER } from '@angular/core';\nimport { Analytics as FirebaseAnalytics, isSupported } from 'firebase/analytics';\nimport { ɵgetDefaultInstanceOf, ɵmemoizeInstance, ɵAngularFireSchedulers, VERSION } from '@angular/fire';\nimport { Analytics, ANALYTICS_PROVIDER_NAME, AnalyticsInstances } from './analytics';\nimport { FirebaseApps, FirebaseApp } from '@angular/fire/app';\nimport { registerVersion } from 'firebase/app';\n\nconst PROVIDED_ANALYTICS_INSTANCES = new InjectionToken<Analytics[]>('angularfire2.analytics-instances');\nconst IS_SUPPORTED = new InjectionToken<boolean>('angularfire2.analytics.isSupported');\n\nconst isSupportedSymbol = Symbol('angularfire2.analytics.isSupported');\n\nexport function defaultAnalyticsInstanceFactory(isSupported: boolean, provided: FirebaseAnalytics[]|undefined, defaultApp: FirebaseApp) {\n  const defaultAnalytics = isSupported ?\n    ɵgetDefaultInstanceOf<FirebaseAnalytics>(ANALYTICS_PROVIDER_NAME, provided, defaultApp) :\n    undefined;\n  return new Analytics(defaultAnalytics);\n}\n\nexport function analyticsInstanceFactory(fn: () => FirebaseAnalytics) {\n  return (zone: NgZone, isSupported: boolean) => {\n    const analytics = isSupported ? ɵmemoizeInstance<FirebaseAnalytics>(fn, zone) : undefined;\n    return new Analytics(analytics);\n  };\n}\n\nconst ANALYTICS_INSTANCES_PROVIDER = {\n  provide: AnalyticsInstances,\n  deps: [\n    [new Optional(), PROVIDED_ANALYTICS_INSTANCES ],\n  ]\n};\n\nconst DEFAULT_ANALYTICS_INSTANCE_PROVIDER = {\n  provide: Analytics,\n  useFactory: defaultAnalyticsInstanceFactory,\n  deps: [\n    IS_SUPPORTED,\n    [new Optional(), PROVIDED_ANALYTICS_INSTANCES ],\n    FirebaseApp,\n  ]\n};\n\n@NgModule({\n  providers: [\n    DEFAULT_ANALYTICS_INSTANCE_PROVIDER,\n    ANALYTICS_INSTANCES_PROVIDER,\n    {\n      provide: APP_INITIALIZER,\n      useValue: () => isSupported().then(it => globalThis[isSupportedSymbol] = it),\n      multi: true,\n    },\n  ]\n})\nexport class AnalyticsModule {\n  constructor() {\n    registerVersion('angularfire', VERSION.full, 'analytics');\n  }\n}\n\nexport function provideAnalytics(fn: () => FirebaseAnalytics): ModuleWithProviders<AnalyticsModule> {\n  return {\n    ngModule: AnalyticsModule,\n    providers: [{\n      provide: IS_SUPPORTED,\n      useFactory: () => globalThis[isSupportedSymbol],\n    }, {\n      provide: PROVIDED_ANALYTICS_INSTANCES,\n      useFactory: analyticsInstanceFactory(fn),\n      multi: true,\n      deps: [\n        NgZone,\n        IS_SUPPORTED,\n        ɵAngularFireSchedulers,\n        FirebaseApps,\n      ]\n    }]\n  };\n}\n","// DO NOT MODIFY, this file is autogenerated by tools/build.ts\nexport * from 'firebase/analytics';\nimport { ɵzoneWrap } from '@angular/fire';\nimport {\n  getAnalytics as _getAnalytics,\n  initializeAnalytics as _initializeAnalytics,\n  isSupported as _isSupported,\n  logEvent as _logEvent,\n  setAnalyticsCollectionEnabled as _setAnalyticsCollectionEnabled,\n  setCurrentScreen as _setCurrentScreen,\n  settings as _settings,\n  setUserId as _setUserId,\n  setUserProperties as _setUserProperties\n} from 'firebase/analytics';\n\nexport const getAnalytics = ɵzoneWrap(_getAnalytics, true);\nexport const initializeAnalytics = ɵzoneWrap(_initializeAnalytics, true);\nexport const isSupported = ɵzoneWrap(_isSupported, true);\nexport const logEvent = ɵzoneWrap(_logEvent, true);\nexport const setAnalyticsCollectionEnabled = ɵzoneWrap(_setAnalyticsCollectionEnabled, true);\nexport const setCurrentScreen = ɵzoneWrap(_setCurrentScreen, true);\nexport const settings = ɵzoneWrap(_settings, true);\nexport const setUserId = ɵzoneWrap(_setUserId, true);\nexport const setUserProperties = ɵzoneWrap(_setUserProperties, true);\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["ɵgetAllInstancesOf","timer","concatMap","from","distinct","InjectionToken","ɵgetDefaultInstanceOf","ɵmemoizeInstance","Optional","FirebaseApp","registerVersion","VERSION","APP_INITIALIZER","isSupported","NgModule","NgZone","ɵAngularFireSchedulers","FirebaseApps","ɵzoneWrap","_getAnalytics","_initializeAnalytics","_isSupported","_logEvent","_setAnalyticsCollectionEnabled","_setCurrentScreen","_settings","_setUserId","_setUserProperties"],"mappings":"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"}