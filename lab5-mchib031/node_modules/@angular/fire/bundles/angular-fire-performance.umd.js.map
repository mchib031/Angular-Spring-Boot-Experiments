{"version":3,"file":"angular-fire-performance.umd.js","sources":["../../../src/performance/performance.ts","../../../src/performance/performance.module.ts","../../../src/performance/rxfire.ts","../../../src/performance/firebase.ts","../../../src/performance/angular-fire-performance.ts"],"sourcesContent":["import { FirebasePerformance } from 'firebase/performance';\nimport { ɵgetAllInstancesOf } from '@angular/fire';\nimport { from, timer } from 'rxjs';\nimport { concatMap, distinct } from 'rxjs/operators';\n\n// see notes in core/firebase.app.module.ts for why we're building the class like this\n// tslint:disable-next-line:no-empty-interface\nexport interface Performance extends FirebasePerformance {}\n\nexport class Performance {\n  constructor(performance: FirebasePerformance) {\n    return performance;\n  }\n}\n\nexport const PERFORMANCE_PROVIDER_NAME = 'performance';\n\n// tslint:disable-next-line:no-empty-interface\nexport interface PerformanceInstances extends Array<FirebasePerformance> {}\n\nexport class PerformanceInstances {\n  constructor() {\n    return ɵgetAllInstancesOf<FirebasePerformance>(PERFORMANCE_PROVIDER_NAME);\n  }\n}\n\nexport const performanceInstance$ = timer(0, 300).pipe(\n  concatMap(() => from(ɵgetAllInstancesOf<FirebasePerformance>(PERFORMANCE_PROVIDER_NAME))),\n  distinct(),\n);\n","import { NgModule, Optional, NgZone, InjectionToken, ModuleWithProviders } from '@angular/core';\nimport { FirebasePerformance } from 'firebase/performance';\nimport { ɵgetDefaultInstanceOf, ɵmemoizeInstance, ɵAngularFireSchedulers, VERSION } from '@angular/fire';\nimport { Performance, PerformanceInstances, PERFORMANCE_PROVIDER_NAME } from './performance';\nimport { FirebaseApps, FirebaseApp } from '@angular/fire/app';\nimport { registerVersion } from 'firebase/app';\n\nexport const PROVIDED_PERFORMANCE_INSTANCES = new InjectionToken<Performance[]>('angularfire2.performance-instances');\n\nexport function defaultPerformanceInstanceFactory(provided: FirebasePerformance[]|undefined, defaultApp: FirebaseApp) {\n  const defaultPerformance = ɵgetDefaultInstanceOf<FirebasePerformance>(PERFORMANCE_PROVIDER_NAME, provided, defaultApp);\n  return new Performance(defaultPerformance);\n}\n\nexport function performanceInstanceFactory(fn: () => FirebasePerformance) {\n  return (zone: NgZone) => {\n    const performance = ɵmemoizeInstance<FirebasePerformance>(fn, zone);\n    return new Performance(performance);\n  };\n}\n\nconst PERFORMANCE_INSTANCES_PROVIDER = {\n  provide: PerformanceInstances,\n  deps: [\n    [new Optional(), PROVIDED_PERFORMANCE_INSTANCES ],\n  ]\n};\n\nconst DEFAULT_PERFORMANCE_INSTANCE_PROVIDER = {\n  provide: Performance,\n  useFactory: defaultPerformanceInstanceFactory,\n  deps: [\n    [new Optional(), PROVIDED_PERFORMANCE_INSTANCES ],\n    FirebaseApp,\n  ]\n};\n\n@NgModule({\n  providers: [\n    DEFAULT_PERFORMANCE_INSTANCE_PROVIDER,\n    PERFORMANCE_INSTANCES_PROVIDER,\n  ]\n})\nexport class PerformanceModule {\n  constructor() {\n    registerVersion('angularfire', VERSION.full, 'perf');\n  }\n}\n\nexport function providePerformance(fn: () => FirebasePerformance): ModuleWithProviders<PerformanceModule> {\n  return {\n    ngModule: PerformanceModule,\n    providers: [{\n      provide: PROVIDED_PERFORMANCE_INSTANCES,\n      useFactory: performanceInstanceFactory(fn),\n      multi: true,\n      deps: [\n        NgZone,\n        ɵAngularFireSchedulers,\n        FirebaseApps,\n      ]\n    }]\n  };\n}\n","// DO NOT MODIFY, this file is autogenerated by tools/build.ts\nimport { ɵzoneWrap } from '@angular/fire';\nimport {\n  traceUntil as _traceUntil,\n  traceWhile as _traceWhile,\n  traceUntilComplete as _traceUntilComplete,\n  traceUntilFirst as _traceUntilFirst\n} from 'rxfire/performance';\n\nexport const traceUntil = ɵzoneWrap(_traceUntil, true);\nexport const traceWhile = ɵzoneWrap(_traceWhile, true);\nexport const traceUntilComplete = ɵzoneWrap(_traceUntilComplete, true);\nexport const traceUntilFirst = ɵzoneWrap(_traceUntilFirst, true);\n","// DO NOT MODIFY, this file is autogenerated by tools/build.ts\nexport * from 'firebase/performance';\nimport { ɵzoneWrap } from '@angular/fire';\nimport {\n  getPerformance as _getPerformance,\n  initializePerformance as _initializePerformance,\n  trace as _trace\n} from 'firebase/performance';\n\nexport const getPerformance = ɵzoneWrap(_getPerformance, true);\nexport const initializePerformance = ɵzoneWrap(_initializePerformance, true);\nexport const trace = ɵzoneWrap(_trace, true);\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["ɵgetAllInstancesOf","timer","concatMap","from","distinct","InjectionToken","ɵgetDefaultInstanceOf","ɵmemoizeInstance","Optional","FirebaseApp","registerVersion","VERSION","NgModule","NgZone","ɵAngularFireSchedulers","FirebaseApps","ɵzoneWrap","_traceUntil","_traceWhile","_traceUntilComplete","_traceUntilFirst","_getPerformance","_initializePerformance","_trace"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAUE,qBAAY,WAAgC;YAC1C,OAAO,WAAW,CAAC;SACpB;0BACF;KAAA,IAAA;IAEM,IAAM,yBAAyB,GAAG,aAAa,CAAC;;QAMrD;YACE,OAAOA,uBAAkB,CAAsB,yBAAyB,CAAC,CAAC;SAC3E;mCACF;KAAA,IAAA;QAEY,oBAAoB,GAAGC,UAAK,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,IAAI,CACpDC,mBAAS,CAAC,cAAM,OAAAC,SAAI,CAACH,uBAAkB,CAAsB,yBAAyB,CAAC,CAAC,GAAA,CAAC,EACzFI,kBAAQ,EAAE;;ICrBL,IAAM,8BAA8B,GAAG,IAAIC,iBAAc,CAAgB,oCAAoC,CAAC,CAAC;aAEtG,iCAAiC,CAAC,QAAyC,EAAE,UAAuB;QAClH,IAAM,kBAAkB,GAAGC,0BAAqB,CAAsB,yBAAyB,EAAE,QAAQ,EAAE,UAAU,CAAC,CAAC;QACvH,OAAO,IAAI,WAAW,CAAC,kBAAkB,CAAC,CAAC;IAC7C,CAAC;aAEe,0BAA0B,CAAC,EAA6B;QACtE,OAAO,UAAC,IAAY;YAClB,IAAM,WAAW,GAAGC,qBAAgB,CAAsB,EAAE,EAAE,IAAI,CAAC,CAAC;YACpE,OAAO,IAAI,WAAW,CAAC,WAAW,CAAC,CAAC;SACrC,CAAC;IACJ,CAAC;IAED,IAAM,8BAA8B,GAAG;QACrC,OAAO,EAAE,oBAAoB;QAC7B,IAAI,EAAE;YACJ,CAAC,IAAIC,WAAQ,EAAE,EAAE,8BAA8B,CAAE;SAClD;KACF,CAAC;IAEF,IAAM,qCAAqC,GAAG;QAC5C,OAAO,EAAE,WAAW;QACpB,UAAU,EAAE,iCAAiC;QAC7C,IAAI,EAAE;YACJ,CAAC,IAAIA,WAAQ,EAAE,EAAE,8BAA8B,CAAE;YACjDC,eAAW;SACZ;KACF,CAAC;;QASA;YACEC,qBAAe,CAAC,aAAa,EAAEC,YAAO,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;SACtD;;;wIAHU,iBAAiB;yIAAjB,iBAAiB;yIAAjB,iBAAiB,aALjB;YACT,qCAAqC;YACrC,8BAA8B;SAC/B;qHAEU,iBAAiB;sBAN7BC,WAAQ;uBAAC;wBACR,SAAS,EAAE;4BACT,qCAAqC;4BACrC,8BAA8B;yBAC/B;qBACF;;aAOe,kBAAkB,CAAC,EAA6B;QAC9D,OAAO;YACL,QAAQ,EAAE,iBAAiB;YAC3B,SAAS,EAAE,CAAC;oBACV,OAAO,EAAE,8BAA8B;oBACvC,UAAU,EAAE,0BAA0B,CAAC,EAAE,CAAC;oBAC1C,KAAK,EAAE,IAAI;oBACX,IAAI,EAAE;wBACJC,SAAM;wBACNC,2BAAsB;wBACtBC,gBAAY;qBACb;iBACF,CAAC;SACH,CAAC;IACJ;;IC/DA;QASa,UAAU,GAAGC,cAAS,CAACC,wBAAW,EAAE,IAAI,EAAE;QAC1C,UAAU,GAAGD,cAAS,CAACE,wBAAW,EAAE,IAAI,EAAE;QAC1C,kBAAkB,GAAGF,cAAS,CAACG,gCAAmB,EAAE,IAAI,EAAE;QAC1D,eAAe,GAAGH,cAAS,CAACI,6BAAgB,EAAE,IAAI;;ICZ/D;QASa,cAAc,GAAGJ,cAAS,CAACK,0BAAe,EAAE,IAAI,EAAE;QAClD,qBAAqB,GAAGL,cAAS,CAACM,iCAAsB,EAAE,IAAI,EAAE;QAChE,KAAK,GAAGN,cAAS,CAACO,iBAAM,EAAE,IAAI;;ICX3C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}